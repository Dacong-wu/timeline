<script setup>
import { onMounted } from 'vue'
import gsap from 'gsap'
import ScrollTrigger from 'gsap/ScrollTrigger'
// import ScrollSmoother from 'gsap/ScrollSmoother'

const info = [
  {
    name: 'p-1',
    value: 'üíñ2018-0215‚Üí2023-0807üíñ'
  },
  {
    name: 'p-2',
    value: 'Êó∂Èó¥ËøáÁöÑÂ§™Âø´Âï¶üöÄ'
  },
  {
    name: 'p-3',
    value: '‰∏ÄÁú®ÁúºÈÉΩÂú®‰∏ÄËµ∑1999Â§©‰∫Üüåº'
  },
  {
    name: 'p-4',
    value: 'Êç¢ÁÆó‰∏Ä‰∏ãÂ∞±ÊòØ5.4Âπ¥üßè‚Äç‚ôÄÔ∏è'
  },
  {
    name: 'p-5',
    value: '‰ªäÂ§©ËØ•ÊÄé‰πàÂ∫ÜÁ•ùÂë¢üéâ'
  },
  {
    name: 'p-6',
    value: 'ÊÉ≥Êù•ÊÉ≥ÂéªÔºåËøô‰πàÂ•ΩÁöÑÊó•Â≠êüåù'
  },
  {
    name: 'p-7',
    value: '‰∏ÄËà¨Ê¥ªÂä®ÈÉΩÊúâÁÇπÈÖç‰∏ç‰∏äü´®'
  },
  {
    name: 'p-8',
    value: '1999ÔºåÈïøÈïø‰πÖ‰πÖüê£'
  },
  {
    name: 'p-9',
    value: 'Ë¶Å‰∏çÊ±ÇÂ©öÂêßüåà'
  },
  {
    name: 'p-10',
    value: 'ÊâÄ‰ª•‰Ω†Áé∞Âú®ÁúãÂà∞‰∫ÜËøô‰∏™ÁΩëÂùÄüê•'
  },
  {
    name: 'p-11',
    value: 'ÂæàÂ∫ÜÂπ∏Ôºå‰ªñÊ≤°ÊúâË¢´Ê≥®ÂÜåüå∫'
  },
  {
    name: 'p-12',
    value: 'ËÆ©Ëøô‰∏ÄÂàªÂú®‰∫íËÅîÁΩë‰∏äÂÆöÊ†ºÂêßüì∏'
  },
  {
    name: 'p-13',
    value: 'ÁæéÁæé‰∏ΩÁöÑÂ∞èËéâËéâÔºåÂ´ÅÁªôÊàëÂêßüíç'
  }
]

onMounted(() => {
  gsap.registerPlugin(ScrollTrigger) //Ê≥®ÂÜåÊèí‰ª∂
  fromToClassLogo() //logoÂÖÉÁ¥†ËøõÂú∫Âä®Áîª
  let scrollTl = scrollTimeline() //ÂàõÂª∫Êó∂Èó¥ËΩ¥ÂØπË±°
  scrollTlFromToClassLogo(scrollTl) //LogoÊªöÂä®Âä®Áîª
  scrollTlFromToClassP1()
})

// logoÂÖÉÁ¥†ËøõÂú∫Âä®Áîª
function fromToClassLogo() {
  /*
    .inÔºöË°®Á§∫ÁºìÂä®ÂáΩÊï∞ÁöÑËøõÂÖ•Èò∂ÊÆµÔºåÂç≥Âä®ÁîªÂºÄÂßãÊó∂ÁöÑÁºìÂä®ÊïàÊûú„ÄÇ
    .outÔºöË°®Á§∫ÁºìÂä®ÂáΩÊï∞ÁöÑÁ¶ªÂºÄÈò∂ÊÆµÔºåÂç≥Âä®ÁîªÁªìÊùüÊó∂ÁöÑÁºìÂä®ÊïàÊûú„ÄÇ
  */
  gsap.fromTo(
    '.logo',
    {
      opacity: 0,
      yPercent: 100
    },
    {
      yPercent: 0,
      opacity: 1,
      duration: 1,
      ease: 'power3.out'
    }
  )
}

// ÂàõÂª∫ÊªöÂä®Êó∂Èó¥ËΩ¥Âä®Áîª
function scrollTimeline() {
  /*
  trigger Â±ûÊÄßÊåáÂÆö‰∫ÜËß¶ÂèëÂä®ÁîªÁöÑÂÖÉÁ¥†ÔºåËøôÈáå‰ΩøÁî®ÁöÑÊòØ document.bodyÔºåÂç≥Êï¥‰∏™ÊñáÊ°£ÁöÑ body ÂÖÉÁ¥†„ÄÇ
  start Â±ûÊÄßÊåáÂÆö‰∫ÜÂä®ÁîªÂºÄÂßãÁöÑ‰ΩçÁΩÆÔºåËøôÈáåËÆæÁΩÆ‰∏∫ 0ÔºåË°®Á§∫ÂΩìÊªöÂä®Âà∞È°µÈù¢È°∂ÈÉ®Êó∂ÂºÄÂßãËß¶ÂèëÂä®Áîª„ÄÇ
  end Â±ûÊÄßÊåáÂÆö‰∫ÜÂä®ÁîªÁªìÊùüÁöÑ‰ΩçÁΩÆÔºåËøôÈáå‰ΩøÁî®‰∏Ä‰∏™ÂáΩÊï∞ () => window.innerHeight * 1.2ÔºåË°®Á§∫ÂΩìÊªöÂä®Âà∞Á™óÂè£È´òÂ∫¶ÁöÑ 1.2 ÂÄçÊó∂ÁªìÊùüÂä®Áîª„ÄÇËøôÊ†∑ÂèØ‰ª•ËÆæÁΩÆ‰∏Ä‰∏™ÁªìÊùüÁÇπÔºå‰ΩøÂä®Áîª‰∏ç‰ºöÊó†ÈôêÂú∞ÁªßÁª≠Êí≠Êîæ„ÄÇ
  scrub Â±ûÊÄßÊåáÂÆö‰∫ÜÂä®ÁîªÁöÑÂπ≥ÊªëÂ∫¶ÔºåËøôÈáåËÆæÁΩÆ‰∏∫ 0.6ÔºåË°®Á§∫Âú®ÊªöÂä®ËøáÁ®ã‰∏≠Âä®ÁîªÁöÑÊí≠ÊîæÈÄüÂ∫¶Áõ∏ÂØπ‰∫éÊªöÂä®ÈÄüÂ∫¶ÁöÑ 0.6 ÂÄçÔºåÂèØ‰ª•ÂÆûÁé∞‰∏ÄÁßçÂπ≥ÊªëÁöÑÊïàÊûú„ÄÇ
  */
  return gsap.timeline({
    scrollTrigger: {
      trigger: '.gasp-body',
      start: 0,
      end: () => window.innerHeight,
      scrub: 0.8
    }
  })
}

// logo ÊªöÂä®Âä®Áîª
function scrollTlFromToClassLogo(scrollTl) {
  let from = {
    top: 'calc(50vh - 77px)',
    scale: 4,
    textShadow: '0 0 2px rgba(0,0,0,0.3)'
  }
  let to = {
    // top: 'calc(0vh - 0px)',
    opacity: 0,
    scale: 1,
    textShadow: '0 0 2px rgba(0,0,0,0)',
    duration: 1
  }
  // ÁßªÂä®Á´ØÈÄÇÈÖçÊõ¥Êîπ
  if (window.matchMedia('(max-width: 576px)').matches) {
    from.rotation = 90
    from.scale = 2
    to.rotation = 0
  }
  scrollTl.fromTo('.logo', from, to).set('.logo', { top: 'calc(0vh - 0px)' })
  scrollTl.fromTo('.logo', { opacity: 0 }, { opacity: 1 })
}

function scrollTlFromToClassP1() {
  for (let i = 0, len = info.length; i < len; i++) {
    let item = info[i].name
    let percent = (50 / len) * i
    gsap.from(`.${item}`, {
      scale: 0.5,
      rotate: 10,
      filter: 'blur(4px)',
      opacity: 0,
      scrollTrigger: {
        trigger: `.${item}`,
        start: getStart(item),
        end: `bottom ${percent + 50}%`,
        scrub: 0.8
        // markers: true
      }
    })
  }
}
function getStart(name) {
  let height = window.innerHeight
  let start = document.getElementsByClassName(name)[0].offsetTop - height
  return start
}
</script>
<template>
  <div class="gasp-body">
    <header>
      <div class="logo">
        <TitleDay1999 />
      </div>
    </header>
    <main>
      <div class="gallery">
        <p
          v-for="item in info"
          :key="item.name"
          class="p-all"
          :class="item.name"
          >{{ item.value }}</p
        >
      </div>
    </main>
    <footer class="">
      <span>
        <a
          target="_blank"
          href="https://beian.miit.gov.cn/#/Integrated/index"
        >
          <p>ËãèICPÂ§á2021045936Âè∑-2</p>
        </a>
      </span>
    </footer>
  </div>
</template>
<style lang="scss" scoped>
$primary-back-color: #fff5da;
$logo-height: 77px;

.gasp-body {
  min-height: 100vh;
  background-color: $primary-back-color;

  header {
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    background: $primary-back-color;
    height: $logo-height;
    z-index: 1;

    .logo {
      text-align: center;
      position: relative;
      top: 0;
      width: 100%;
      text-shadow: 0 0 2px rgba(0, 0, 0, 0.3);
    }
  }

  main {
    padding: 0 10%;
    @media #{$phone} {
      padding: 0 2rem;
    }

    .gallery {
      color: $primary-color;
      padding-top: 100vh;
      padding-bottom: 5vh;
      padding-left: 0;
      .p-all {
        font-size: 60px;
        width: 100%;
        text-align: center;
        @media #{$phone} {
          font-size: 30px;
        }
      }
    }
  }

  footer{
  display: flex;
  width: 100%;
  justify-content: center;
  align-items: center;
  height: 40px;
  padding-bottom: env(safe-area-inset-bottom);
  span {
    padding: 0 5px;
  }
  p {
    color: $primary-color;
    font-size: 12px;
    margin: 0;
    padding: 10px 0;
  }
}

}
</style>
